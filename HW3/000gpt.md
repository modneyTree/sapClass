//관련 코드
//INCLUDE ZEDR20_HW003_TOP.
*&---------------------------------------------------------------------*
*&  Include           ZEDR20_HW003_TOP
*&---------------------------------------------------------------------*

TABLES : ZEDT20_100.
TABLES : ZEDT20_101.

"변수 선언
CONSTANTS : C_X TYPE CHAR1 VALUE 'X'.
RANGES : R_FLAG FOR ZEDT20_100-ZSALE_FG.  " 반품내역 포함


DATA : BEGIN OF GS_ORDER, "주문 관리 테이블
  ZORDNO LIKE ZEDT20_100-ZORDNO,  "주문 번호
  ZIDCODE LIKE ZEDT20_100-ZIDCODE, "회원ID
  ZMATNR LIKE ZEDT20_100-ZMATNR,  "제품 번호
  ZMTART LIKE ZEDT20_100-ZMTART,  "제품유형
  ZMATNAME LIKE ZEDT20_100-ZMATNAME,  "제품명
  ZVOLUM LIKE ZEDT20_100-ZVOLUM,  "수량
  VOLUM LIKE ZEDT20_100-VOLUM,  "Volume
  VRKME LIKE ZEDT20_100-VRKME,  "Sales Unit
  ZNSAMT LIKE ZEDT20_100-ZNSAMT,  "판매금액
  ZSLAMT LIKE ZEDT20_100-ZSLAMT,  "매출금액
  ZDCAMT LIKE ZEDT20_100-ZDCAMT,  "할인금액
  ZDC_FG LIKE ZEDT20_100-ZDC_FG,  "할인구분
  ZSALE_FG LIKE ZEDT20_100-ZSALE_FG,"매출구분
  ZRET_FG LIKE ZEDT20_100-ZRET_FG,  "반품구분
  ZJDATE LIKE ZEDT20_100-ZJDATE,  "판매일자
  ZRDATE LIKE ZEDT20_100-ZRDATE,  "반품일자
  END OF GS_ORDER.
DATA : GT_ORDER LIKE TABLE OF GS_ORDER.

DATA : BEGIN OF GS_ORDER_ALV, "주문 관리 ALV 출력용
*  ZCOLOR_RGB(3), "구분(매출, 반품)
  LIGHT_ICON TYPE C LENGTH 4,
  ZORDNO LIKE ZEDT20_100-ZORDNO,  "주문 번호
  ZIDCODE LIKE ZEDT20_100-ZIDCODE, "회원ID
  ZMATNR LIKE ZEDT20_100-ZMATNR,  "제품 번호
*  ZMTART LIKE ZEDT20_100-ZMTART,  "제품유형
  ZMATNAME LIKE ZEDT20_100-ZMATNAME,  "제품명
  ZMTART_NAME(10), "제품유형_이름
  ZVOLUM LIKE ZEDT20_100-ZVOLUM,  "수량
*  VOLUM LIKE ZEDT20_100-VOLUM,  "Volume
  VRKME LIKE ZEDT20_100-VRKME,  "Sales Unit
  ZNSAMT LIKE ZEDT20_100-ZNSAMT,  "판매금액
  ZSLAMT LIKE ZEDT20_100-ZSLAMT,  "매출금액
  ZDCAMT LIKE ZEDT20_100-ZDCAMT,  "할인금액
  ZDC_FG LIKE ZEDT20_100-ZDC_FG,  "*할인구분
  ZSALE_FG LIKE ZEDT20_100-ZSALE_FG,"*매출구분
  ZSALE_FG_NAME(2), "매출구분_NAME
  ZRET_FG LIKE ZEDT20_100-ZRET_FG,  "*반품구분
  ZRET_FG_NAME(4), "반품구분_NAME
  ZJDATE LIKE ZEDT20_100-ZJDATE,  "판매일자
  ZRDATE LIKE ZEDT20_100-ZRDATE,  "반품일자
  END OF GS_ORDER_ALV.
DATA : GT_ORDER_ALV LIKE TABLE OF GS_ORDER_ALV.

DATA : BEGIN OF GS_DELEVER, "배송 관리 테이블
  ZORDNO LIKE ZEDT20_101-ZORDNO,  "주문 번호
  ZIDCODE LIKE ZEDT20_101-ZIDCODE, "회원ID
  ZMATNR LIKE ZEDT20_101-ZMATNR,  "제품 번호
  ZMTART LIKE ZEDT20_101-ZMTART,  "제품유형
  ZMATNAME LIKE ZEDT20_101-ZMATNAME,  "제품명
  ZVOLUM LIKE ZEDT20_101-ZVOLUM,  "수량
  VOLUM LIKE ZEDT20_101-VOLUM,  "Volume
  VRKME LIKE ZEDT20_101-VRKME,  "Sales Unit
  ZSLAMT LIKE ZEDT20_101-ZSLAMT,  "매출금액
  ZDFLAG LIKE ZEDT20_101-ZDFLAG,  "배송현황
  ZDGUBUN LIKE ZEDT20_101-ZDGUBUN,  "배송지역
  ZDDATE LIKE ZEDT20_101-ZDDATE,  "배송일자
  ZRDATE LIKE ZEDT20_101-ZRDATE,  "반품일자
  ZFLAG LIKE ZEDT20_101-ZFLAG,  "반품체크
  END OF GS_DELEVER.
DATA : GT_DELEVER LIKE TABLE OF GS_DELEVER.

DATA : BEGIN OF GS_DELEVER_ALV, "배송 관리 테이블
  LIGHT_ICON TYPE C LENGTH 4,
  ZORDNO LIKE ZEDT20_101-ZORDNO,  "주문 번호
  ZIDCODE LIKE ZEDT20_101-ZIDCODE, "회원ID
  ZMATNR LIKE ZEDT20_101-ZMATNR,  "제품 번호
  ZMATNAME LIKE ZEDT20_101-ZMATNAME,  "제품명
  ZMTART LIKE ZEDT20_101-ZMTART,  "제품유형
  ZMTART_NAME(10), "제품유형_이름
  ZVOLUM LIKE ZEDT20_101-ZVOLUM,  "수량
  VRKME LIKE ZEDT20_101-VRKME,  "Sales Unit
  ZSLAMT LIKE ZEDT20_101-ZSLAMT,  "매출금액
  ZDFLAG_NAME(10), "배송현황_NAME
  ZDGUBUN_NAME(10), "배송지역_NAME
  ZDDATE LIKE ZEDT20_101-ZDDATE,  "배송일자
  ZRDATE LIKE ZEDT20_101-ZRDATE,  "반품일자
  ZFLAG LIKE ZEDT20_101-ZFLAG,  "반품체크
  END OF GS_DELEVER_ALV.
DATA : GT_DELEVER_ALV LIKE TABLE OF GS_DELEVER_ALV.

DATA : OK_CODE TYPE SY-UCOMM.
DATA : LIGHT_ICON TYPE CHAR30.

DATA : GC_DOCKING TYPE REF TO CL_GUI_DOCKING_CONTAINER.
"그리드생성
DATA : GC_GRID TYPE REF TO CL_GUI_ALV_GRID.

DATA : GS_VARIANT TYPE DISVARIANT.

"필드카탈로그
DATA : GS_FIELDCAT TYPE LVC_S_FCAT.
DATA : GT_FIELDCAT TYPE LVC_T_FCAT.
DATA : GS_FIELDCAT2 TYPE LVC_S_FCAT.
DATA : GT_FIELDCAT2 TYPE LVC_T_FCAT.
DATA : GS_FIELDCAT_F TYPE LVC_S_FCAT.
DATA : GT_FIELDCAT_F TYPE LVC_T_FCAT.
"레이아웃
DATA : GS_LAYOUT TYPE LVC_S_LAYO.
DATA : GS_LAYOUT2 TYPE LVC_S_LAYO.
DATA : GS_LAYOUT_F TYPE LVC_S_LAYO.
"SORT
DATA : GS_SORT TYPE LVC_S_SORT.
DATA : GT_SORT TYPE LVC_T_SORT.
DATA : GS_SORT2 TYPE LVC_S_SORT.
DATA : GT_SORT2 TYPE LVC_T_SORT.
DATA : GS_SORT_F TYPE LVC_S_SORT.
DATA : GT_SORT_F TYPE LVC_T_SORT.

//INCLUDE ZEDR20_HW003_PAI.
*&---------------------------------------------------------------------*
*&  Include           ZEDR20_HW003_PAI
*&---------------------------------------------------------------------*

MODULE EXIT_COMMAND INPUT.

  CASE OK_CODE.
    WHEN 'BACK' OR 'CANC'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'PDF'.
      " PDF 저장 로직을 작성한다.
    ENDCASE.

ENDMODULE.


// 과제 힌트
OLE구성 
1.디렉토리지정
CL_GUI_FRONTEND_SERVICES=>GET_TEMP_DIRECTORY
CL_GUI_FRONTEND_SERVICES=>DIRECTORY_BROWSE

2.DOWNLOAD_TEMPLATE
CALL FUNCTION 'WS_FILE_DELETE'

  SELECT SINGLE *
    FROM WWWDATA

CALL FUNCTION 'DOWNLOAD_WEB_OBJECT'

3.OPEN_EXCEL_TEMPLATE 
EXCEL  TYPE OLE2_OBJECT (그룹풀 : OLE2)
  CALL METHOD OF
    EXCEL
  CALL METHOD OF
    WORKBOOK

4. FILL_EXCEL_LINE
5. DELETE  FILE
CL_GUI_FRONTEND_SERVICES=>FILE_DELETE



// 요청사항
위 힌트를 사용해서 ALV의 선택된 한 줄을 바탕화면에 pdf로 저장하는 코드를 작성해줘

PDF버튼 만들어서 사용자가 한라인 클릭 후 버튼을 누르면 로컬 바탕화면에 저장될 수 있게 소스 구현
(여러줄 클릭하면 , "한 데이터만 선택 가능합니다" 에러)
PDF출력물에는 아래와 같이 출력될 수 있게 
주문번호 : 
회원ID : 
제품번호, 제품명
매출금액
판매일자
